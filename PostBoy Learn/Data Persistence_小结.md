# 这次的需求是为企业微信收集表做数据持久化
## 这次我负责了补充数据持久化，没有对接创建企业微信收集表的接口，再写代码前看了看创建企业微信收集表的接口，主要思路如下
```
1.通过应用的唯一标识也就是AppId获取自建应用与企业；实现思路：通过AppId去企业微信后台获取应用，再通过应用中的企业id去企业微信后台获取企业信息；
2.通过应用secret(访问密钥)和企业的CorpId获取access_token（之后去看封装的一些方法）；
3.调用企业微信后台创建收集表接口，判断是否添加成功；
4.成功后，获取调用企业微信后台获取收集表的接口，判断是否获取成功；
5.成功后，将其添加入本地数据库，做数据持久化；
access_token是企业后台去企业微信的后台获取信息时的重要票据，由corpid和secret产生。所有接口在通信时都需要携带此信息用于验证接口的访问权限
```
## 遇到的卡位：
```
1.返回的数据结构复杂，有多个层级：
  a.设计合理的数据结构存储到数据库；
  b.将有多层级的列的数据转化成json存储起来；
  选择了b，a虽然更符合数据的结构但是需要创建更多表，不便于后期管理；
2.在转化成json存储到数据库时，使用varchar(1500)还是不足已存储，后面使用text的类型；
```
[char, varchar, text区别](https://blog.csdn.net/m0_37787662/article/details/125615577)
## 好的思想：
### 1.在mapping里面进行json序列化，不需要在读取数据集合再进行序列化，代码更加简洁。
## 遗漏点：
### 1.写集成测试时，mock服务时忘记将服务注册实例了。
